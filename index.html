<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Pok√©Scan (OCR)</title>
  <style>
    :root { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; }
    body { margin:0; background:#0b1220; color:#e5e7eb; }
    .wrap { max-width: 560px; margin: 0 auto; padding: 14px; }
    .card {
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 16px;
      padding: 12px;
      box-shadow: 0 12px 30px rgba(0,0,0,.35);
    }
    .row { display:flex; gap:10px; flex-wrap: wrap; align-items:center; }
    button{
      appearance:none; border:0; border-radius: 14px; padding: 12px 14px;
      background: #2563eb; color:white; font-weight: 800; cursor:pointer;
      box-shadow: 0 10px 20px rgba(37,99,235,.25);
    }
    button:disabled{ opacity:.5; cursor:not-allowed; }
    .muted { color:#94a3b8; font-size: 13px; line-height: 1.4; }
    video, canvas.preview { width:100%; border-radius: 14px; background:#000; }
    .bar { height: 10px; background: rgba(255,255,255,.10); border-radius: 999px; overflow:hidden; }
    .bar > div { height:100%; width:0%; background: #22c55e; transition: width .2s; }
    img { width: 100%; border-radius: 14px; }
    .pill {
      display:inline-block; padding:6px 10px; border-radius: 999px;
      border:1px solid rgba(255,255,255,.14); background: rgba(255,255,255,.06);
      font-size: 13px;
    }
    input {
      width: 100%;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color:#e5e7eb;
      outline: none;
      font-size: 15px;
    }
    .hint {
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px dashed rgba(255,255,255,.16);
      background: rgba(255,255,255,.04);
      margin-top: 10px;
    }
    details { margin-top: 10px; }
    summary { cursor: pointer; color:#cbd5e1; }
  </style>
</head>

<body>
  <div class="wrap">
    <h2 style="margin: 4px 0 10px;">üì∑ Pok√©Scan (OCR)</h2>
    <p class="muted" style="margin-top:0;">
      Enfoca la carta (idealmente la parte del nombre) y pulsa <b>Escanear</b>.
      Mejor con buena luz y sin reflejos.
    </p>

    <div class="card" style="margin-bottom:12px;">
      <video id="video" playsinline autoplay muted></video>

      <!-- canvases internos (uno para frame y otro para recorte + preproceso) -->
      <canvas id="frame" style="display:none;"></canvas>
      <canvas id="crop" class="preview" style="display:none;"></canvas>

      <div class="row" style="margin-top:10px;">
        <button id="btnStart">Activar c√°mara</button>
        <button id="btnScan" disabled>Escanear</button>
        <button id="btnToggleCrop" disabled>Ver recorte</button>
        <span class="pill" id="status">Listo</span>
      </div>

      <div style="margin-top:10px;">
        <div class="bar"><div id="prog"></div></div>
        <div class="muted" id="log" style="margin-top:6px;"></div>
      </div>

      <div class="hint">
        <div class="muted" style="margin-bottom:6px;"><b>Tip r√°pido:</b> inclina un poquito la carta para evitar reflejos.</div>
        <div class="muted">Si el OCR falla, prueba acercar la c√°mara y que el nombre quede n√≠tido.</div>
      </div>

      <div style="margin-top:12px;">
        <div class="muted">Nombre detectado (puedes editarlo
