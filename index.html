<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>PokÃ©Scan Fun (recorte manual)</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="wrap">
    <h2>ğŸ“· PokÃ©Scan Fun</h2>
    <p class="muted">
      Truco para cartas brillantes: inclina un poquito la carta para evitar reflejos, y toma foto.
      Luego mueve el recorte encima del <b>nombre</b> o del <b>cÃ³digo</b> (ej: <b>DRI 104/182</b>).
    </p>

    <div class="card">
      <div class="row">
        <button id="btnStart">Activar cÃ¡mara</button>
        <button id="btnSnap" disabled>Tomar foto</button>
        <label class="fileBtn">
          Subir foto
          <input id="file" type="file" accept="image/*" capture="environment" />
        </label>
        <span class="pill" id="status">Listo</span>
      </div>

      <div class="bar"><div id="prog"></div></div>
      <div class="muted" id="log"></div>

      <video id="video" playsinline autoplay muted></video>

      <!-- Editor con recorte -->
      <div id="editor" class="editor hidden">
        <div class="editorTop">
          <button id="btnPresetName" class="ghost">ğŸ¯ Nombre</button>
          <button id="btnPresetCode" class="ghost">ğŸ¯ CÃ³digo</button>
          <button id="btnOCR" class="primary">ğŸ§  OCR del recorte</button>
          <button id="btnSearch" class="ghost" disabled>ğŸ” Buscar carta</button>
        </div>

        <div class="stage" id="stage">
          <canvas id="photo"></canvas>
          <div id="cropBox" class="cropBox" role="application" aria-label="Recorte"></div>
          <div id="handles" class="handles">
            <div class="h tl" data-handle="tl"></div>
            <div class="h tr" data-handle="tr"></div>
            <div class="h bl" data-handle="bl"></div>
            <div class="h br" data-handle="br"></div>
          </div>
        </div>

        <div class="grid2">
          <div>
            <div class="muted">Texto OCR:</div>
            <textarea id="ocrText" placeholder="AquÃ­ saldrÃ¡ lo detectadoâ€¦"></textarea>
          </div>
          <div>
            <div class="muted">CÃ³digo encontrado / editable:</div>
            <input id="codeBox" placeholder="Ej: DRI 104/182" />
            <div class="muted" style="margin-top:8px;">
              TambiÃ©n puedes escribir el nombre aquÃ­ arriba y usar â€œBuscar cartaâ€.
            </div>
          </div>
        </div>
      </div>

      <canvas id="hiddenWork" class="hidden"></canvas>
    </div>

    <div class="card">
      <div id="result" class="muted">Sin resultados aÃºn.</div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
  <script src="app.js"></script>
</body>
</html>
